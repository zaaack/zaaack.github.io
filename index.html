<!DOCTYPE html>
<html lang="">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Zack's Blog, to record Zack's learning, coding, developing and life."/><link rel="alternate" href="/atom.xml" title="Zack's Blog" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/avatar.png?v=2.11.0" />
<link rel="canonical" href="https://zaaack.github.io/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>Zack's Blog</title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Zack's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">首页
          </li>
      </a><a href="/projects">
        <li class="mobile-menu-item">项目
          </li>
      </a><a href="/tools">
        <li class="mobile-menu-item">工具
          </li>
      </a><a href="/tags">
        <li class="mobile-menu-item">标签
          </li>
      </a><a href="/archives">
        <li class="mobile-menu-item">归档
          </li>
      </a><a href="/about">
        <li class="mobile-menu-item">关于
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Zack's Blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/projects">
            项目
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tools">
            工具
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            标签
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives">
            归档
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about">
            关于
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/win11-remote-desktop/">win11 家庭版开启远程登录</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2024-07-28
        </span></div>
    </header>

    <div class="post-content"><h2 id="1-开启-rdp"><a href="#1-开启-rdp" class="headerlink" title="1. 开启 rdp"></a>1. 开启 rdp</h2><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ministep/p/15829494.html#41__55">https://www.cnblogs.com/ministep/p/15829494.html#41__55</a></p>
<h2 id="2-vnc"><a href="#2-vnc" class="headerlink" title="2. vnc"></a>2. vnc</h2><p>服务端安装 tightvnc, 试了tigervnc 和 utralvnc 都不太稳定</p>
<p>客户端用 realvnc 或者 utralvnc, tightvnc</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/ss/">机场推荐大全</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2022-03-23
        </span></div>
    </header>

    <div class="post-content"><p>unarto/share-ssr-v2ray-ss-akun - <a target="_blank" rel="noopener" href="https://github.com/unarto/share-ssr-v2ray-ss-akun">https://github.com/unarto/share-ssr-v2ray-ss-akun</a></p>
<p>hwanz/SSR-V2ray-Trojan-vpn: 免费白嫖公益机场合集SSR-V2ray/免费vpn-定时更新 - <a target="_blank" rel="noopener" href="https://github.com/hwanz/SSR-V2ray-Trojan-vpn">https://github.com/hwanz/SSR-V2ray-Trojan-vpn</a></p>
<p>最新SSR/V2ray专线机场推荐与评测(2022.03更新) - ssrv2ray - <a target="_blank" rel="noopener" href="https://hwzhwz.github.io/posts/8c826425.html">https://hwzhwz.github.io/posts/8c826425.html</a></p>
<p>jichangjiedian/README.md at c4bef7829bf424b012ee5debc3e04966aed43bd0 · sqlemma/jichangjiedian - <a target="_blank" rel="noopener" href="https://github.com/sqlemma/jichangjiedian/blob/c4bef7829bf424b012ee5debc3e04966aed43bd0/README.md">https://github.com/sqlemma/jichangjiedian/blob/c4bef7829bf424b012ee5debc3e04966aed43bd0/README.md</a></p>
<p>free-ssr-v2ray/README.md at 2fd01d5967fd7d22131f55155cf6d8d3b86d16d9 · honven/free-ssr-v2ray - <a target="_blank" rel="noopener" href="https://github.com/honven/free-ssr-v2ray/blob/2fd01d5967fd7d22131f55155cf6d8d3b86d16d9/README.md">https://github.com/honven/free-ssr-v2ray/blob/2fd01d5967fd7d22131f55155cf6d8d3b86d16d9/README.md</a></p>
<p>jichangjiedian/README.md at main · sqlemma/jichangjiedian - <a target="_blank" rel="noopener" href="https://github.com/sqlemma/jichangjiedian/blob/main/README.md">https://github.com/sqlemma/jichangjiedian/blob/main/README.md</a></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/vscode-markdown-editor/">vscode 秒变 全功能 所见即所得 markdown 编辑器</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-04-08
        </span></div>
    </header>

    <div class="post-content"><p>最近写了一些  markdown， 在 vscode 上感觉一般的纯文本文档写起来还是比较舒服的，但是如果有表格编辑起来就比较麻烦了，排版很困难，于是想起了最近很多基于 electron/nwjs 的所见即所得的 markdown 编辑器，比如 typora, marktext 等等, 如果在 vscode 中实现类似功能编辑起来就很方便了。</p>
<p>于是便写了这个插件:</p>
<p><img src="https://ftp.bmp.ovh/imgs/2021/04/0799ad9b7657907d.gif"></p>
<p>插件地址： <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=zaaack.markdown-editor">https://marketplace.visualstudio.com/items?itemName=zaaack.markdown-editor</a></p>
<p>源码地址： <a target="_blank" rel="noopener" href="https://github.com/zaaack/vscode-markdown-editor">https://github.com/zaaack/vscode-markdown-editor</a></p>
<p>基于强大 <a target="_blank" rel="noopener" href="https://ld246.com/article/1549638745630">vditor</a> 项目，vscode 端并不需要多少代码即可拥有众多 feature:</p>
<ul>
<li>可视化编辑 markdown</li>
<li>图片上传 /粘贴</li>
<li>黑暗模式, 多种代码高亮样式</li>
<li>大纲、数学公式、脑图、图表、流程图、甘特图、时序图、五线谱、多媒体、语音阅读、标题锚点、代码高亮及复制、graphviz 渲染、plantumlUML 图</li>
<li>…</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/tools/"></a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-03-31
        </span></div>
    </header>

    <div class="post-content"><h1 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h1><h2 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h2><table>
<thead>
<tr>
<th>项目</th>
<th align="left">简介</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://u.tools/">utools</a></td>
<td align="left">启动器，Alfred 替代品</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.fancynode.com.cn/pxcook">PxCook</a></td>
<td align="left">sketch 预览工具，除此还有Sketch Measure, zeplin,蓝湖…</td>
</tr>
<tr>
<td>httppie</td>
<td align="left">http client 命令行工具</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.softmaker.com/en/softmaker-office">softmaker-office</a></td>
<td align="left">mac上启动最快的 office 套件</td>
</tr>
<tr>
<td>LICEcap</td>
<td align="left">mac 上压缩率最高的gif录屏软件</td>
</tr>
<tr>
<td>稻壳阅读器</td>
<td align="left">高性能 pdf/epub 阅读器</td>
</tr>
<tr>
<td>magicanrest</td>
<td align="left">定时锁屏休息</td>
</tr>
<tr>
<td>坚果云网盘</td>
<td align="left">文件同步</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://www.sqltabs.com/#">sqltab</a></td>
<td align="left">免费聚合数据库客户端</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/pavlobu/deskreen">deskscreen</a></td>
<td align="left">把手机/pad 等设备变成扩展屏幕(跨平台)</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://espanso.org/">espanso</a></td>
<td align="left">跨平台的系统全局snippets，文本快捷输入，支持 emoji</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://macwk.com/soft/tinycal">tinycal</a> 小历日历</td>
<td align="left"></td>
</tr>
</tbody></table>
<h1 id="win10-11"><a href="#win10-11" class="headerlink" title="win10/11"></a>win10/11</h1><table>
<thead>
<tr>
<th align="left">项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://icons8.cn/lunacy">lunacy</a></td>
<td>win10打开编辑sketch文件</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://github.com/CzBiX/WSLHostPatcher/">WSLHostPatcher</a></td>
<td>wsl2 服务在局域网可访问</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://github.com/openhardwaremonitor/openhardwaremonitor">openhardware</a>/<a target="_blank" rel="noopener" href="http://www.alcpu.com/CoreTemp/">coretemp</a></td>
<td>cpu温度监控</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://shuax.com/project/mouseinc/">mouseinc</a></td>
<td>鼠标手势+触发角</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://github.com/hovancik/stretchly">stretchly</a></td>
<td>20分钟锁屏休息20s</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://github.com/emoacht/Monitorian">Monitorian</a></td>
<td>外接显示器亮度修改</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://github.com/xfangfang/Macast">macast</a></td>
<td>dlina流媒体投屏接收软件</td>
</tr>
<tr>
<td align="left">RevokeMsgPatcher.v1.7</td>
<td>qq/微信防撤回</td>
</tr>
<tr>
<td align="left">TrafficMonitor</td>
<td>流量监控</td>
</tr>
<tr>
<td align="left">猫影绿色免安装1.0.7_fix2</td>
<td></td>
</tr>
<tr>
<td align="left">ProjectEye</td>
<td>护眼提醒</td>
</tr>
<tr>
<td align="left">wsa工具箱</td>
<td>wsa安卓工具箱</td>
</tr>
<tr>
<td align="left">Clash (设置里的LoopbackManager)</td>
<td>代理(uwp应用设置)</td>
</tr>
<tr>
<td align="left">ScreenToGif</td>
<td>高压缩最小的 gif录屏软件</td>
</tr>
<tr>
<td align="left">xdown</td>
<td>下载器</td>
</tr>
<tr>
<td align="left">zyplayer</td>
<td>影视</td>
</tr>
<tr>
<td align="left">geek uninstaller</td>
<td></td>
</tr>
<tr>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left"></td>
<td></td>
</tr>
<tr>
<td align="left"></td>
<td></td>
</tr>
</tbody></table>
<h1 id="跨平台"><a href="#跨平台" class="headerlink" title="跨平台"></a>跨平台</h1><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td>local-cors-proxy/npm</td>
<td>本地反向代理服务添加 cors header</td>
</tr>
<tr>
<td>caddy</td>
<td>go版 反向代理服务器</td>
</tr>
<tr>
<td>NeatDownloadManager</td>
<td>多线程下载工具</td>
</tr>
<tr>
<td>xdown</td>
<td>bt下载工具</td>
</tr>
<tr>
<td>spacedesk</td>
<td>屏幕扩展</td>
</tr>
</tbody></table>
<h1 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h1><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td>Postern</td>
<td>代理切换</td>
</tr>
</tbody></table>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="效率-1"><a href="#效率-1" class="headerlink" title="效率"></a>效率</h2><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://github.com/excalidraw/excalidraw">excalidraw</a></td>
<td>手写样式的流程图</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/steveruizok/perfect-freehand">perfect-freehand</a></td>
<td>毛笔画图</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://draw.io/">draw.io</a></td>
<td>在线流程图</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.figma.com/">figma</a></td>
<td>在线原型图, 可以导出svg</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://alternativeto.com/">alternativeto.com</a></td>
<td>替代品查找网站</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://asciiflow.com/">asciiflow</a></td>
<td>基于文本的流程图</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://tool.lu/">tool.lu</a></td>
<td>程序员工具箱</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.google.com/search?q=%E5%9C%A8%E7%BA%BF%E6%8E%A5%E7%A0%81&oq=%E5%9C%A8%E7%BA%BF%E6%8E%A5%E7%A0%81&aqs=chrome..69i64j69i60l3j69i61j69i60j69i65l2.2429j0j1&sourceid=chrome&ie=UTF-8">在线接码</a></td>
<td>临时手机号用于注册小号</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.photopea.com/">photopea</a></td>
<td>在线ps, 支持导入 sketch 预览，不过只能看图</td>
</tr>
<tr>
<td><a href="tailscale.com">tailscale.com</a></td>
<td>免费vpn组网，支持远程访问内网机器</td>
</tr>
<tr>
<td><a href="./ss">ss</a></td>
<td>机场推荐</td>
</tr>
</tbody></table>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.bookzz.ren/">bookzz</a></td>
<td>电子书下载</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.bookrix.de/">bookrix</a></td>
<td>电子书下载</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://zh.singlelogin.org/">z-library</a></td>
<td>zlibrary电子书</td>
</tr>
</tbody></table>
<h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://gitpod.io/">gitpod.io</a></td>
<td>在线开发环境, db/IDE/shell 等 (开源免费)</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://pushover.net/">poshover</a></td>
<td>推送服务</td>
</tr>
<tr>
<td>微信绑定qq邮箱发邮件</td>
<td>同上</td>
</tr>
<tr>
<td>Server 酱/喵提醒/Telegram 订阅/钉钉机器人 /PushPlus/gotify/ddpush</td>
<td>同上</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://vercel.com/">vercel</a>/<a target="_blank" rel="noopener" href="https://www.netlify.com/">netlify</a></td>
<td>云服务serverless</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://xiaomiqiu.cn/">小米球</a> <a target="_blank" rel="noopener" href="https://github.com/open-dingtalk/pierced">钉钉内网穿透</a> <a target="_blank" rel="noopener" href="http://www.nat123.com/">nat123</a></td>
<td>内网穿透</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://ghproxy.com/">ghproxy</a>/<a target="_blank" rel="noopener" href="http://toolwa.com/github/">toolwa</a></td>
<td>github下载加速</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/zellij-org/zellij">zellij</a></td>
<td>tmux 替代品，界面更友好，对鼠标支持更好</td>
</tr>
</tbody></table>
<h2 id="娱乐"><a href="#娱乐" class="headerlink" title="娱乐"></a>娱乐</h2><table>
<thead>
<tr>
<th>项目</th>
<th>简介</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.sayloving.com/movie.html">vip视频解析</a></td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://hao.misiai.com/#/">网盘聚合搜索</a></td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://v.ranks.xin/">v视频下载</a></td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://downsub.com/">downsub</a></td>
<td>下载YouTube字幕</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://www.youtubemy.com/">https://www.youtubemy.com</a> （网友自荐，还不错），可用</td>
<td>youtube 视频下载</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://pickvideo.net/">https://pickvideo.net/</a>(被河蟹，需要爬梯子)  -》</td>
<td>同上</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://bitdownloader.com/en2">https://bitdownloader.com/en2</a></td>
<td>同上</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://www.clipconverter.cc/">http://www.clipconverter.cc/</a> (</td>
<td>同上</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://fetchvideo.com/">http://fetchvideo.com/</a> (正常)</td>
<td>同上</td>
</tr>
<tr>
<td>mkvtoolnix</td>
<td>最快的字幕封装工具，将字幕导入到视频</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://github.com/cuiocean/ZY-Player">ZY-Player</a></td>
<td>全网视频客户端</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/svg-auto-wrapped-text-component-for-react/">svg 文本自动换行 React 组件</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-08-16
        </span></div>
    </header>

    <div class="post-content"><p>SVG 的 text 标签是不支持自动换行的，但是如果想用 svg 作为一个画图模版还是需要文本换行。这个组件可以自动对 svg 节点进行截断，支持 tspan 单独设置样式，比如改变颜色啥的，但是暂时不支持 tspan 改变文本宽度，因为用的是别人写的测量宽度的包。本来这个作者也有个换行组件的，但是看源码发现不支持中文，所以写了这个组件。</p>
<p>用法:</p>
<pre class="line-numbers language-js" data-language="js"><code class="language-js">

<span class="token operator">&lt;</span>AutoText
    width<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">50</span> <span class="token operator">/</span> <span class="token number">375</span> <span class="token operator">*</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">&#125;</span> <span class="token comment">// width should be 'px'</span>
    x<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">47</span><span class="token punctuation">&#125;</span> <span class="token comment">// x, y can be svg coordinate</span>
    y<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">337</span><span class="token punctuation">&#125;</span>
    fill<span class="token operator">=</span><span class="token string">"#494949"</span>
    fontFamily<span class="token operator">=</span><span class="token string">"SourceHanSerif-Regular, Source Han Serif"</span>
    fontSize<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">13</span><span class="token punctuation">&#125;</span>
    fontWeight<span class="token operator">=</span><span class="token string">"normal"</span>
    lineSpacing<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span> <span class="token comment">// or line-height</span>
    spans<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">[</span>
        <span class="token string">'Helllo，'</span><span class="token punctuation">,</span>
        <span class="token punctuation">&#123;</span> tag<span class="token operator">:</span> <span class="token string">'tspan'</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'Amy'</span><span class="token punctuation">,</span> props<span class="token operator">:</span> <span class="token punctuation">&#123;</span> fill<span class="token operator">:</span> <span class="token string">'#B09148'</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token string">', '</span><span class="token punctuation">,</span>
        <span class="token string">'what can I do for you?'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
<span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-js" data-language="js"><code class="language-js">
<span class="token keyword">import</span> <span class="token string">'core-js/fn/set'</span>
<span class="token keyword">import</span> <span class="token string">'core-js/fn/map'</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> svgTextSize <span class="token keyword">from</span> <span class="token string">'svg-text-size'</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> rightSymbols <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>
  <span class="token string">'“‘[「【﹝〔&lt;‹«&#123;『（(&lt;《'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> leftSymbols <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>
  <span class="token string">',，,！!?？”\]」】》>’»﹞〕〗〉&#125;)）』'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> toggleSymbols <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// Takes a string, and a width (and svg attrs, if they apply), and returns</span>
<span class="token comment">// an array of lines, representing the break points in the string.</span>
<span class="token keyword">const</span> <span class="token function-variable function">textWrap</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> width<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> doc <span class="token operator">=</span> document<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  _leftSymbols <span class="token operator">=</span> leftSymbols<span class="token punctuation">,</span>
  _rightSymbols <span class="token operator">=</span> rightSymbols<span class="token punctuation">,</span>
  _toggleSymbols <span class="token operator">=</span> toggleSymbols<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> words <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> toggleMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> text<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> char <span class="token operator">=</span> text<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_rightSymbols<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>char <span class="token operator">+</span> text<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      i <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_leftSymbols<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      words<span class="token punctuation">[</span>words<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> char
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_toggleSymbols<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">let</span> isRightStart <span class="token operator">=</span> _toggleSymbols<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'right'</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>toggleMap<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        toggleMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> isRightStart <span class="token operator">?</span> <span class="token string">'right'</span> <span class="token operator">:</span> <span class="token string">'left'</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">let</span> stickyDirection <span class="token operator">=</span> toggleMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>stickyDirection <span class="token operator">===</span> <span class="token string">'right'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>char <span class="token operator">+</span> text<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        i <span class="token operator">+=</span> <span class="token number">1</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        words<span class="token punctuation">[</span>words<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> char
      <span class="token punctuation">&#125;</span>
      toggleMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> stickyDirection <span class="token operator">===</span> <span class="token string">'left'</span> <span class="token operator">?</span> <span class="token string">'right'</span> <span class="token operator">:</span> <span class="token string">'left'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\w+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">let</span> last <span class="token operator">=</span> words<span class="token punctuation">[</span>words<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\w+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        words<span class="token punctuation">[</span>words<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> char
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      words<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">let</span> lines <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> currentLine <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  words<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">word</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> newLine <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>currentLine<span class="token punctuation">,</span> word<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token function">svgTextSize</span><span class="token punctuation">(</span>newLine<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>size<span class="token punctuation">.</span>width <span class="token operator">></span> width<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      lines<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>currentLine<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      currentLine <span class="token operator">=</span> <span class="token punctuation">[</span>word<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      currentLine<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  lines<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>currentLine<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> lines<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> lines<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getReactAttr</span><span class="token punctuation">(</span><span class="token parameter">attrs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">let</span> newAttrs <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> val <span class="token operator">=</span> attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    key <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">([A-Z])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token parameter">s</span> <span class="token operator">=></span> <span class="token string">'-'</span> <span class="token operator">+</span> s<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">case</span> <span class="token string">'font-size'</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">'line-spacing'</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">'letter-spacing'</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          val <span class="token operator">+=</span> <span class="token string">'px'</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    newAttrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> newAttrs
<span class="token punctuation">&#125;</span>

<span class="token comment">/**
\```
props: &#123;
 spans: [
   "some text",
   &#123; tag: 'tspan', text: 'some text', props: &#123; &#125; &#125;
 ],
 width: 100,
 x: 0,
 y: 0,
&#125;
\```
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">SVGAutoText</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">&#123;</span>

  <span class="token function">getAttrProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span>
      spans<span class="token punctuation">,</span> width<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span>
      leftSymbols<span class="token punctuation">,</span> rightSymbols<span class="token punctuation">,</span> toggleSymbols<span class="token punctuation">,</span>
      <span class="token operator">...</span>props <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">return</span> props
  <span class="token punctuation">&#125;</span>

  <span class="token function">getWrappedSpans</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> spanSlices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> startIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> fullText <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">let</span> spans <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>spans<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
      <span class="token parameter">span</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>span<span class="token punctuation">.</span>tag<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
            tag<span class="token operator">:</span> <span class="token string">'tspan'</span><span class="token punctuation">,</span>
            text<span class="token operator">:</span> span <span class="token operator">?</span> span <span class="token operator">+</span> <span class="token string">''</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
            props<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        span<span class="token punctuation">.</span>text <span class="token operator">+=</span> <span class="token string">''</span>
        <span class="token keyword">return</span> span
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> span <span class="token keyword">of</span> spans<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">let</span> end <span class="token operator">=</span> startIdx <span class="token operator">+</span> span<span class="token punctuation">.</span>text<span class="token punctuation">.</span>length
      spanSlices<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>span<span class="token punctuation">,</span>
        start<span class="token operator">:</span> startIdx<span class="token punctuation">,</span>
        end<span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
      startIdx <span class="token operator">=</span> end
      fullText <span class="token operator">+=</span> span<span class="token punctuation">.</span>text
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">let</span> globalProps <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttrProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> lines <span class="token operator">=</span> <span class="token function">textWrap</span><span class="token punctuation">(</span>fullText<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token function">getReactAttr</span><span class="token punctuation">(</span>globalProps<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>
    <span class="token keyword">let</span> tspans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> lineIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> lineLen <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> sliceIdx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">let</span> sliceLen <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">let</span> lastLine <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">let</span> <span class="token punctuation">&#123;</span> x<span class="token operator">:</span> offsetX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> offsetY <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">let</span> lineHeight <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>globalProps<span class="token punctuation">[</span><span class="token string">'lineSpacing'</span><span class="token punctuation">]</span> <span class="token operator">||</span> globalProps<span class="token punctuation">[</span><span class="token string">'lineHeight'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> fontSize <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>globalProps<span class="token punctuation">[</span><span class="token string">'fontSize'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">16</span>
    <span class="token keyword">function</span> <span class="token function">makeTspan</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> props<span class="token punctuation">,</span> lineIdx</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">let</span> x <span class="token operator">=</span> lastLine <span class="token operator">===</span> lineIdx <span class="token operator">?</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">:</span> offsetX
      lastLine <span class="token operator">=</span> lineIdx
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>tspan
          key<span class="token operator">=</span><span class="token punctuation">&#123;</span>tspans<span class="token punctuation">.</span>length <span class="token operator">+</span> text<span class="token punctuation">&#125;</span>
          <span class="token punctuation">&#123;</span><span class="token operator">...</span>props<span class="token punctuation">&#125;</span>
          x<span class="token operator">=</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">&#125;</span>
          y<span class="token operator">=</span><span class="token punctuation">&#123;</span>lineIdx <span class="token operator">*</span> <span class="token punctuation">(</span>lineHeight <span class="token operator">?</span> lineHeight <span class="token operator">:</span> fontSize <span class="token operator">*</span> <span class="token number">1.4</span><span class="token punctuation">)</span> <span class="token operator">+</span> offsetY<span class="token punctuation">&#125;</span>
        <span class="token operator">></span>
          <span class="token punctuation">&#123;</span>text<span class="token punctuation">&#125;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tspan<span class="token operator">></span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> line <span class="token keyword">of</span> lines<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      lineLen <span class="token operator">+=</span> line<span class="token punctuation">.</span>length
      <span class="token keyword">while</span> <span class="token punctuation">(</span>sliceLen <span class="token operator">&lt;</span> lineLen <span class="token operator">&amp;&amp;</span> sliceIdx <span class="token operator">&lt;</span> spanSlices<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> slice <span class="token operator">=</span> spanSlices<span class="token punctuation">[</span>sliceIdx<span class="token punctuation">]</span>
        tspans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">makeTspan</span><span class="token punctuation">(</span>slice<span class="token punctuation">.</span>text<span class="token punctuation">,</span> slice<span class="token punctuation">.</span>props<span class="token punctuation">,</span> lineIdx<span class="token punctuation">)</span><span class="token punctuation">)</span>
        sliceIdx<span class="token operator">++</span>
        sliceLen <span class="token operator">+=</span> slice<span class="token punctuation">.</span>text<span class="token punctuation">.</span>length
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>sliceLen <span class="token operator">></span> lineLen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// break slice</span>
        <span class="token keyword">let</span> lastSlice <span class="token operator">=</span> spanSlices<span class="token punctuation">[</span>sliceIdx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">let</span> text1 <span class="token operator">=</span> lastSlice<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lastSlice<span class="token punctuation">.</span>text<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token punctuation">(</span>sliceLen <span class="token operator">-</span> lineLen<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> text2 <span class="token operator">=</span> lastSlice<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>text1<span class="token punctuation">.</span>length<span class="token punctuation">)</span>

        tspans<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        tspans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">makeTspan</span><span class="token punctuation">(</span>text1<span class="token punctuation">,</span> lastSlice<span class="token punctuation">.</span>props<span class="token punctuation">,</span> lineIdx<span class="token punctuation">)</span><span class="token punctuation">)</span>
        tspans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">makeTspan</span><span class="token punctuation">(</span>text2<span class="token punctuation">,</span> lastSlice<span class="token punctuation">.</span>props<span class="token punctuation">,</span> lineIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
      lineIdx<span class="token operator">++</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> tspans
  <span class="token punctuation">&#125;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>text <span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttrProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token operator">></span>
        <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getWrappedSpans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/ios-safari-scroll/">react-native 项目 run-android 报无法安装应用</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-05-27
        </span></div>
    </header>

    <div class="post-content"><pre class="line-numbers language-none"><code class="language-none">z at ZsMBP in ~&#x2F;Projects&#x2F;ReactXP&#x2F;reactxp&#x2F;samples&#x2F;TodoList (master●)
$ react-native run-android
Scanning 740 folders for symlinks in &#x2F;Users&#x2F;z&#x2F;Projects&#x2F;ReactXP&#x2F;reactxp&#x2F;samples&#x2F;TodoList&#x2F;node_modules (7ms)
JS server already running.
Building and installing the app on the device (cd android &amp;&amp; .&#x2F;gradlew installDebug)...
Could not install the app on the device, read the error above for details.
Make sure you have an Android emulator running or a device connected and have
set up your Android development environment:
https:&#x2F;&#x2F;facebook.github.io&#x2F;react-native&#x2F;docs&#x2F;android-setup.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个错误的解释废话太多，还是错的, 其实手动运行下命令<code>cd android &amp;&amp; ./gradlew installDebug</code>就会发现是<code>./android/.gradlew</code> 这个文件没有执行权限导致的，运行一下</p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">chmod +x .&#x2F;android&#x2F;.gradlew<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>就可以了</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/setup-your-front-end-stack-from-zero-6-webpack2/">webpack2 -从0搭建一个完整的前端开发技术栈(6)</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-04-28
        </span></div>
    </header>

    <div class="post-content"><p>之前的框架是 full-stack 的，最近需要帮以前工作室的学妹弄一个简单的 h5 页面时才发现，自己居然手头没有一套靠谱的纯粹配置，如果从其他项目中剥离出来又实在提不起兴趣，于是下了官方的 create-react-app, 发现各种问题，比如</p>
<ol>
<li>不支持 react 热更新，只支持热刷新</li>
<li>与 sass 整合很不方便，sass 直接编译到源码目录，干扰视线。。</li>
<li>babel，webpack 也不支持扩展；</li>
<li>…</li>
</ol>
<p>无法适应大型项目，和我理解中的只是用来写 demo, 或者简单页面的脚手架差不多。临时看了一下 styled-components, 发现这货比我想象的要高级，支持嵌套语法，auto-prefixer, 既然是 css-in-js,那么动态复用就完全不用担心了，更让我惊艳的是工具链的支持，在 atom 中，基本上必装的 language-babel 插件已经默认支持了，在 js 中也可以享受到强大的 css 提示。</p>
<p>于是在 create-react-app + styled-components 的组合下写起展示类页面来体验也挺不错的。</p>
<p>不过，没有一套自己常用的纯前端的脚手架总感觉心里不太安稳，而且转眼过去大半年了，webpack2, react-hot-loader v3 已经是正式版了，个人也积累了一些不错的库，于是便打算再折腾一个最新的脚手架。</p>
<p>作为一名合格的「前端配置工程师」，每半年~一年升级一次配置才能紧跟前端的潮流。。</p>
<p>先放代码：<a target="_blank" rel="noopener" href="https://github.com/zaaack/react-starter.git">https://github.com/zaaack/react-starter.git</a></p>
<p>这里主要记录一下猜到的坑。。</p>
<h4 id="react-hot-loader"><a href="#react-hot-loader" class="headerlink" title="react-hot-loader"></a>react-hot-loader</h4><p>毫无悬念，虽然之前有过成功配置 react-hot-loader 的经历，而且那时也是 v3，只不是是 v3-beta, 现在是 v3 正式版，但是还是在这里卡住了大部分时间…</p>
<p>其实官方的两个 demo 已经是非常友好的了，</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wkwiatek/react-hot-loader-minimal-boilerplate">https://github.com/wkwiatek/react-hot-loader-minimal-boilerplate</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/gaearon/react-hot-boilerplate/tree/next">https://github.com/gaearon/react-hot-boilerplate/tree/next</a></li>
</ul>
<p>webpack2 官方也有一个教程，不过需要注意的是 babel-preset-es2015 的参数配置有点老了，具体可以参考上面的 <a target="_blank" rel="noopener" href="https://github.com/wkwiatek/react-hot-loader-minimal-boilerplate">react-hot-loader-minimal-boilerplate</a></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://webpack.js.org/guides/hmr-react/">https://webpack.js.org/guides/hmr-react/</a></li>
</ul>
<p>不过 react-hot-loader 还是太 hack了点，很多地方都需要加 patch，不仅仅是在 entry 中，babel presets 中也要加。开始时就是忘了加 babel presets 中的 <code>react-hot-loader/babel</code>, 导致虽然 log 正常，但是却完全没反应。没有报错提示无意是最难调试的了，只能去翻源码以及在源码中加 log。</p>
<p>发现之后加上去了，但是还是老样子，到底是哪里有问题呢？经过反复耐心测试才发现居然是少了 babel-polyfill, 而且还不能使用 babel-transform-runtime, 虽然之前的配置中 可以通过对 transform-runtime 加 {polyfill:false} 参数使之共存，但是这个 trick 貌似在最新版中不能用了，不过没关系，可以通过 NODE_ENV 区分啊，大不了 开发环境就不加嘛。</p>
<p>可是这样还是不行，不过还好在反复实践中发现<br>虽然 webpack 中配置了 babel, 但是还是会去读取 .bablerc 文件，在翻 babel-loader 的源码时在文档中成功找到了相关依据，改了一个配置就搞定了。。此时 react-hot-loader 所有的坑都已填满，可以放心食用了。。</p>
<h4 id="react-测试"><a href="#react-测试" class="headerlink" title="react 测试"></a>react 测试</h4><p>其实之前一直都没写过 react 测试，老实说除了一些基础 node 库之外，我还没在业务代码中写过测试呢，更不用说 UI 测试了。。所以这次就干脆把测试也加上了。React 自带了 <code>react-dom/test-utils</code>，不过 API 太过冗长，Facebook 自己都不用， 参考了下阮老师的<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/02/react-testing-tutorial.html">这篇</a>, 发现很多 demo 都跑不起来了，倒不仅仅是因为接口的变动，更坑的是 bug…bug.</p>
<p>比如 <code>renderIntoDocument</code> 这个方法，最新的 react 已经去掉了返回值，就算看源码自己用 callback 实现也不行，因为我就尝试了，callback 也没有返回值了！连之前 callback 可以用的 <code>this</code>也变成 null 了。。所以要么直接用 document，要么用 airbnb 的 enzyme, 考虑到写测试是一件很痛苦的事情, 而且<br>enzyme 的接口其实和 jquery 很类似，目测挺方便的，本着不给自己添麻烦原则，就只能牺牲一下硬盘空间了。。我的 node_modules 目录已经快撑爆了吧。。</p>
<p>然而，随便给 demo 代码写了点 测试，想点击一个 react-router 的 Link 实现跳转，死活没反应。在 js-dom 的官方 readme 上看见了巨大的 “不支持跳转” 的说明，好吧，这很好解决，加个 <code>NODE_ENV=test</code> 换成 <code>createMemoryHistory</code> 不就可以了，issue 中也有类似的解决方案。可以还不行！！！一样的没有任何报错，任何反应（可见良好的错误提示是多么重要）。无聊之下又开始翻源码，打 log, 可以确定事件是触发了的，于是又去看 react-router 的 Link 组件，打 log, 终于发现是 因为 Link 中为了确保是鼠标左键点击做了 <code>event.button === 0</code> 的判断，而 jsdom 中的 <code>MouseEvent.button === undefined</code>, 并且是个老 issue 了，果断再来<a target="_blank" rel="noopener" href="https://github.com/tmpvar/jsdom/issues/1831">一发</a>。</p>
<p>至于 Facebook 官方的测试框架 jest 强大的 snapshot 功能，可喜的发现 AVA 已经 内置了，使用非常方便，就不细说了，直接看代码和官方文档吧。</p>
<p>恩，至此所有坑已填完，可以上传 repo 了。是的，这篇文章其实不是什么分享，只是单纯的吐槽，解决这些坑其实几乎毫无价值，半年之后，可能有些修了，可能又会有新的 bug。。人生苦短，且行且珍惜，所以半年更新一下配置，又可以保持一下自己的折腾能力了。。</p>
<p>最后，再来安利一发自己的 react 脚手架 <a target="_blank" rel="noopener" href="https://github.com/zaaack/react-starter.git">react-starter</a>。</p>
<p>以后有时间再整个 koa 后台的 starter，graphql 的，ssr 的。。。</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/mac-proxy-dev/">mac 下代理开发环境总结</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-04-06
        </span></div>
    </header>

    <div class="post-content"><p>在工作中开发，代理技术对于开发环境是不可避免的，小到入职时配置 VPN，再到开发环境中通过代理使用线上 API，通过代理拦截 App 请求，合理的代理应用对于开发来说经常会有事半功倍的作用。这里记录一下我在工作中代理的运用。</p>
<h2 id="1-代理服务器"><a href="#1-代理服务器" class="headerlink" title="1. 代理服务器"></a>1. 代理服务器</h2><p>我这里用的使用的是由阿里巴巴开源的基于 nodejs 的代理工具— <a target="_blank" rel="noopener" href="https://github.com/alibaba/anyproxy">anyproxy</a>，优点是支持 https，使用 nodejs 作为配置文件，学习成本低，<del>缺点是配置 API 看起来太老，连 promise 都不支持，大公司的开源项目不知道什么时候会挂</del>刚上了官网，4.0 beta 已经开始支持 promise 了。</p>
<h2 id="2-手机代理软件"><a href="#2-手机代理软件" class="headerlink" title="2. 手机代理软件"></a>2. 手机代理软件</h2><p>Android 5.0 以下可以使用 DroidProxy 直接修改 wifi 代理配置，但是 5.0 以上更新了安全策略，只能用开 VPN 的了。我这里用的是虽然界面很丑，但是好得能用的 Drony. （以上 APK 可以去 <a target="_blank" rel="noopener" href="https://apkpure.com/">https://apkpure.com</a>搜索下载）。虽然占用了 VPN，不过一般电脑上各种代理和 VPN 都是开启状态，因此手机上还是能走电脑上的代理和 VPN 的。</p>
<p>Drony 和 connectbot 的 ssh 端口转发冲突，导致无法代理 dns 访问电脑 vpn 的内网，localproxy chains 相关配置未测试..</p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/rem-layout/">rem 布局</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-02-10
        </span></div>
    </header>

    <div class="post-content"><pre class="line-numbers language-scss" data-language="scss"><code class="language-scss"><span class="token comment">/**
* /js/lib/flexrem.js
 *
 */</span>

<span class="token property"><span class="token variable">$inital-rem-size</span></span><span class="token punctuation">:</span> 100px <span class="token statement keyword">!default</span><span class="token punctuation">;</span>
<span class="token property"><span class="token variable">$design-width</span></span><span class="token punctuation">:</span> 375px <span class="token statement keyword">!default</span><span class="token punctuation">;</span>


<span class="token selector">html </span><span class="token punctuation">&#123;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token variable">$inital-rem-size</span> <span class="token operator">/</span> <span class="token variable">$design-width</span> <span class="token operator">*</span> 320px<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">@each</span> <span class="token variable">$width</span> in <span class="token punctuation">(</span>320px<span class="token punctuation">,</span> 360px<span class="token punctuation">,</span> 400px<span class="token punctuation">,</span> 414px<span class="token punctuation">,</span> 480px<span class="token punctuation">,</span> 500px<span class="token punctuation">,</span> 650px<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token atrule"><span class="token rule">@media</span> only screen <span class="token operator">and</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> <span class="token variable">#&#123;$width&#125;</span><span class="token punctuation">)</span></span> <span class="token punctuation">&#123;</span>
    <span class="token selector">html </span><span class="token punctuation">&#123;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token variable">$inital-rem-size</span> <span class="token operator">/</span> <span class="token variable">$design-width</span> <span class="token operator">*</span> <span class="token variable">$width</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">@function</span> <span class="token function">px2rem</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">@if</span> <span class="token function">unitless</span><span class="token punctuation">(</span><span class="token variable">$px</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// 不管带不带单位都可以</span>
    <span class="token property"><span class="token variable">$px</span></span><span class="token punctuation">:</span> <span class="token variable">$px</span> <span class="token operator">*</span> 1px<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">@return</span> <span class="token variable">$px</span> <span class="token operator">/</span> <span class="token variable">$inital-rem-size</span> <span class="token operator">*</span> 1rem<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">/**
 *
 * 根据屏幕宽度自动设置html的fontSize, 使rem的大小自适应
 * usage:
 * dui.flexrem(&#123;
 *            //设计稿宽度
 *         		designWidth: &lt;number>, initial: 375
 *         		//rem 初始像素值，initial: 100
 *         		//html的fontSize = (opts.initRem/opts.designWidth*winWidth)+'px'
 *         		initRem: &lt;number>,
 *            //用来计算的最大的 winWidth, initial: 640
 *         		maxWinWidth: &lt;number>
 *            //用来计算的最小的 winWidth, initial: 320
 *            minWinWidth: &lt;number>,
 * &#125;)
 *
 * 由于android webview 偶尔会在 document.load 之后识别 viewport 导致 window.innerWidth 发生变化, 这段 js 需要在 window.onload 后运行，因此还需要配合 css 使加载前页面也能正确显示
 *
 *
 * $inital-rem-size: 100px; // 默认值
 * $design-width: 375px;// 默认值
 * @import '/css/card/widgets/_flexrem.scss';
 *
 * width: @px2rem(12)rem; => 12/100 = 0.12rem
 *
 */</span>

<span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">win<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

  <span class="token keyword">var</span> dui <span class="token operator">=</span> window<span class="token punctuation">.</span>dui <span class="token operator">||</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>dui <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    firstCalled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    defaults <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
      designWidth<span class="token operator">:</span> <span class="token number">375</span><span class="token punctuation">,</span>
      initRem<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      maxWinWidth<span class="token operator">:</span> <span class="token number">640</span><span class="token punctuation">,</span>
      minWinWidth<span class="token operator">:</span> <span class="token number">320</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    evts <span class="token operator">=</span> <span class="token string">'onorientationchange'</span> <span class="token keyword">in</span> win <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">'orientationchange'</span><span class="token punctuation">,</span> <span class="token string">'resize'</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'resize'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>dui<span class="token punctuation">.</span>flexrem <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'flexrem.js shouldn\'t be called twice!!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
    <span class="token comment">/**
     * auto set html's fontSize to make rem flexable
     * @param  &#123;object&#125; opts
     *         &#123;
     *            //设计稿宽度
     *         		designWidth: &lt;number>, initial: 375
     *         		//rem 初始像素值，initial: 100
     *         		//html的fontSize = (opts.initRem/opts.designWidth*winWidth)+'px'
     *         		initRem: &lt;number>,
     *            //用来计算的最大的 winWidth, initial: 960
     *         		maxWinWidth: &lt;number>
     *         &#125;
     * @return
     */</span>
  dui<span class="token punctuation">.</span><span class="token function-variable function">flexrem</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">opts</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>firstCalled<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'flexrem() can only be called once!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    firstCalled <span class="token operator">=</span><span class="token boolean">false</span>
    <span class="token keyword">var</span> options <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> defaults<span class="token punctuation">,</span> opts<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> evts<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>evts<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>setFontSize<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"pageshow"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>persisted<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>setFontSize<span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化</span>
    <span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">setFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">var</span> winWidth <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">||</span> window<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
      winWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>winWidth<span class="token punctuation">,</span> options<span class="token punctuation">.</span>maxWinWidth<span class="token punctuation">)</span>
      winWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>winWidth<span class="token punctuation">,</span> options<span class="token punctuation">.</span>minWinWidth<span class="token punctuation">)</span>
      <span class="token keyword">var</span> size <span class="token operator">=</span> <span class="token punctuation">(</span>winWidth <span class="token operator">/</span> options<span class="token punctuation">.</span>designWidth<span class="token punctuation">)</span> <span class="token operator">*</span> options<span class="token punctuation">.</span>initRem<span class="token punctuation">;</span>
      doc<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> size <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>


  <span class="token keyword">function</span> <span class="token function">toType</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s([a-zA-Z]+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>assign <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  Object<span class="token punctuation">.</span><span class="token function-variable function">assign</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> varArgs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// .length of function is 2</span>
    <span class="token string">'use strict'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// TypeError if undefined or null</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Cannot convert undefined or null to object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">var</span> to <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">var</span> nextSource <span class="token operator">=</span> arguments<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span>nextSource <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// Skip over if undefined or null</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> nextKey <span class="token keyword">in</span> nextSource<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token comment">// Avoid bugs when hasOwnProperty is shadowed</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>nextSource<span class="token punctuation">,</span> nextKey<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            to<span class="token punctuation">[</span>nextKey<span class="token punctuation">]</span> <span class="token operator">=</span> nextSource<span class="token punctuation">[</span>nextKey<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> to<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>



<span class="token punctuation">&#125;</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/linux_import_cert/">linux 导入证书</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-12-21
        </span></div>
    </header>

    <div class="post-content"><p>把<code>xx.crt</code> 文件拷贝到 <code>/usr/local/share/ca-certificates/</code><br>然后运行</p>
<pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo update-ca-certificates<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然后就可以了</p>

        </div></article>
      <nav class="pagination"><a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:zaaack@qq.com" class="iconfont icon-email" title="email"></a>
        <a target="_blank" rel="noopener" href="https://github.com/zaaack" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2024<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Zack</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
